name: Deploy to AKS

on:
  workflow_dispatch:
    inputs:
      MIN_REPLICAS:
        description: 'Minimum number of replicas'
        required: false
        default: '1'
      MAX_REPLICAS:
        description: 'Maximum number of replicas'
        required: false
        default: '5'
      ENTRY_POINT:
        description: 'Entry point command to run the application'
        required: false
        default: 'uv run {{ cookiecutter.repo_name }}/run.py'
      NAMESPACE:
        description: 'Kubernetes namespace to deploy to'
        required: false
        default: 'default'


jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      #call reusable workflow that sits on another repository to deploy to AKS
      - name: Deploy to AKS
        uses: flavio185/reusable-workflow/.github/workflows/deploy-to-k8s@main
        secrets: inherit
        with:
          MIN_REPLICAS: 1
          MAX_REPLICAS: 5
          ENTRY_POINT: "uv run {{ cookiecutter.repo_name }}/run.py"
          NAMESPACE: default
